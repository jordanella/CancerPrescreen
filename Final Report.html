<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>























    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># # Capstone</span>
<span class="c1">#   Final Report</span>
<span class="c1">#   Jordan Ella, 100429623</span>
<span class="c1">#   April 18, 2019</span>
<span class="c1">#/#</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># # Libraries</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="nn">metrics</span>

<span class="c1">#/#</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="s1">&#39;./CancerPScreenRaw.csv&#39;</span> <span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Define a random seed for development</span>
<span class="n">global_seed</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># # Exploratory Data Analysis</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 14980 entries, 0 to 14991
Data columns (total 15 columns):
V1       14980 non-null float64
V2       14980 non-null float64
V3       14980 non-null float64
V4       14980 non-null float64
V5       14980 non-null float64
V6       14980 non-null float64
V7       14980 non-null float64
V8       14980 non-null float64
V9       14980 non-null float64
V10      14980 non-null float64
V11      14980 non-null float64
V12      14980 non-null float64
V13      14980 non-null float64
V14      14980 non-null float64
Class    14980 non-null float64
dtypes: float64(15)
memory usage: 1.8 MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Visualization of Correlations</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span> <span class="n">dataset</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">)</span>

<span class="c1"># Pairplot</span>
<span class="n">pairplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Class&quot;</span> <span class="p">)</span>
<span class="n">pairplot</span>

<span class="c1">#/#</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;seaborn.axisgrid.PairGrid at 0x11450f602e8&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># # Data Preparation</span>

<span class="c1"># Define dependent and independent variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span> <span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span> <span class="s1">&#39;Class&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># * Binary Conversion</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">temp</span>

<span class="c1">#/*</span>

<span class="c1"># Split data for training and testing</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">global_seed</span> <span class="p">)</span>

<span class="c1"># Clean training data</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="n">clean_dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">clean_dataset</span> <span class="o">=</span> <span class="n">clean_dataset</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">clean_dataset</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">clean_dataset</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">14</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">clean_dataset</span><span class="p">[:,</span> <span class="mi">14</span><span class="p">]</span>

<span class="c1"># SMOTE</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="k">import</span> <span class="n">SMOTE</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">()</span>
<span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">#/#</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># # Modeling</span>

<span class="c1"># * Parameter Tuning</span>

<span class="c1"># - Includes</span>

<span class="c1"># Construct Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GridSearchCV</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1">#/-</span>

<span class="c1"># - Pipeline</span>

<span class="c1"># Initilize optimization model</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">RepeatedKFold</span>
<span class="n">cv2</span> <span class="o">=</span> <span class="n">RepeatedKFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">global_seed</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="c1"># Define pipelines</span>
<span class="n">kn_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>
<span class="n">rf_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">())])</span>
<span class="n">gb_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span><span class="p">())])</span>
<span class="n">ab_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span><span class="p">())])</span>

<span class="c1">#/-</span>

<span class="c1"># - Parameter Definition</span>

<span class="c1"># kNeighborsClassifier</span>
<span class="n">opt_kn_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clf__n_neighbors&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
<span class="n">opt_kn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">kn_pipe</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">opt_kn_param</span><span class="p">,</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># RandomForestClassifier</span>
<span class="n">opt_rf_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clf__n_estimators&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                <span class="s2">&quot;clf__criterion&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
                <span class="s2">&quot;clf__random_state&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">global_seed</span><span class="p">]}</span>
<span class="n">opt_rf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">rf_pipe</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">opt_rf_param</span><span class="p">,</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># GradientBoostingClassifier</span>
<span class="n">opt_gb_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clf__n_estimators&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span>
                <span class="s2">&quot;clf__learning_rate&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;clf__random_state&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">global_seed</span><span class="p">]}</span>
<span class="n">opt_gb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">gb_pipe</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">opt_gb_param</span><span class="p">,</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># AdaBoostClassifier</span>
<span class="n">opt_ab_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clf__n_estimators&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span>
                <span class="s2">&quot;clf__algorithm&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SAMME&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMME.R&#39;</span><span class="p">],</span>
                <span class="s2">&quot;clf__random_state&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">global_seed</span><span class="p">]}</span>
<span class="n">opt_ab</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ab_pipe</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">opt_ab_param</span><span class="p">,</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># List of pipelines for ease of iteration</span>
<span class="n">grids</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt_rf</span><span class="p">,</span> <span class="n">opt_ab</span><span class="p">,</span> <span class="n">opt_gb</span><span class="p">,</span> <span class="n">opt_kn</span><span class="p">]</span>
<span class="n">grid_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="s1">&#39;rf&#39;</span><span class="p">,</span>
             <span class="mi">1</span> <span class="p">:</span> <span class="s1">&#39;ab&#39;</span><span class="p">,</span>
             <span class="mi">2</span> <span class="p">:</span> <span class="s1">&#39;gb&#39;</span><span class="p">,</span>
             <span class="mi">3</span> <span class="p">:</span> <span class="s1">&#39;kn&#39;</span><span class="p">}</span>

<span class="c1">#/-</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># - GridsearchCV</span>

<span class="c1"># Create table to compare MLA metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create Dataframe for MLA Analysis</span>
<span class="n">MLA_columns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">MLA_compare</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">MLA_columns</span><span class="p">)</span>

<span class="n">row_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">gs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grids</span><span class="p">):</span>

    <span class="c1"># Fit utilizing SMOTE</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span><span class="p">)</span>

    <span class="c1"># Nested CV</span>
    <span class="n">scoresNestedPre</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                             <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;precision_weighted&#39;</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                             <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">scoresNestedRec</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                             <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;recall_weighted&#39;</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                             <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#Create Dataframe to Compare Models</span>
    <span class="n">MLA_compare</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span><span class="s1">&#39;Algorithm Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">MLA_compare</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span><span class="s1">&#39;Train Accuracy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">MLA_compare</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span><span class="s1">&#39;Precision-NestedCV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:0.2f}</span><span class="s1"> +/- </span><span class="si">{:0.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scoresNestedPre</span><span class="p">),</span>
                                                                           <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scoresNestedPre</span><span class="p">)))</span>
    <span class="n">MLA_compare</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span><span class="s1">&#39;Recall-NestedCV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:0.2f}</span><span class="s1"> +/- </span><span class="si">{:0.2f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scoresNestedRec</span><span class="p">),</span>
                                                                           <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scoresNestedRec</span><span class="p">)))</span>
    <span class="n">MLA_compare</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="s1">&#39;MLA Parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
    <span class="n">row_index</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">MLA_compare</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Train Accuracy&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">MLA_compare</span>

<span class="c1">#/-</span>

<span class="c1">#/*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Algorithm Name</th>
      <th>Train Accuracy</th>
      <th>Precision-NestedCV</th>
      <th>Recall-NestedCV</th>
      <th>MLA Parameters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>kn</td>
      <td>0.98</td>
      <td>0.50 +/- 0.00</td>
      <td>0.50 +/- 0.01</td>
      <td>{&#39;clf__n_neighbors&#39;: 1}</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rf</td>
      <td>0.94</td>
      <td>0.50 +/- 0.01</td>
      <td>0.51 +/- 0.02</td>
      <td>{&#39;clf__criterion&#39;: &#39;entropy&#39;, &#39;clf__n_estimators&#39;: 100, &#39;clf__random_state&#39;: 100}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gb</td>
      <td>0.92</td>
      <td>0.51 +/- 0.01</td>
      <td>0.50 +/- 0.02</td>
      <td>{&#39;clf__learning_rate&#39;: 0.5, &#39;clf__n_estimators&#39;: 250, &#39;clf__random_state&#39;: 100}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ab</td>
      <td>0.76</td>
      <td>0.54 +/- 0.02</td>
      <td>0.54 +/- 0.01</td>
      <td>{&#39;clf__algorithm&#39;: &#39;SAMME.R&#39;, &#39;clf__n_estimators&#39;: 100, &#39;clf__random_state&#39;: 100}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># * Evaluation</span>

<span class="c1"># - EvaluateModel( y_test, y_test, y_pred )</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="k">def</span> <span class="nf">EvaluateModel</span><span class="p">(</span> <span class="n">model</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="p">)</span> <span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Model Score : &#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">confusion_matrix</span><span class="p">(</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span> <span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">classification_report</span><span class="p">(</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

<span class="c1">#/-</span>

<span class="c1"># - RandomForestClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">model_rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span> <span class="n">criterion</span> <span class="o">=</span> <span class="s2">&quot;entropy&quot;</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">global_seed</span> <span class="p">)</span>
<span class="n">model_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span> <span class="p">)</span>
<span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span> <span class="n">x_test</span> <span class="p">)</span>

<span class="n">EvaluateModel</span><span class="p">(</span> <span class="n">model_rf</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_rf</span> <span class="p">)</span>

<span class="c1">#/-</span>

<span class="c1"># - KNeighborsClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">model_kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span> <span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span>
<span class="n">model_kn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span> <span class="p">)</span>
<span class="n">y_pred_kn</span> <span class="o">=</span> <span class="n">model_kn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span> <span class="n">x_test</span> <span class="p">)</span>

<span class="n">EvaluateModel</span><span class="p">(</span> <span class="n">model_kn</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_kn</span> <span class="p">)</span>

<span class="c1">#/-</span>

<span class="c1"># - GradientBoostingClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="n">model_gb</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">global_seed</span> <span class="p">)</span>
<span class="n">model_gb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span> <span class="p">)</span>
<span class="n">y_pred_gb</span> <span class="o">=</span> <span class="n">model_gb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span> <span class="n">x_test</span> <span class="p">)</span>

<span class="n">EvaluateModel</span><span class="p">(</span> <span class="n">model_gb</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_gb</span> <span class="p">)</span>

<span class="c1">#/-</span>

<span class="c1"># - AdaBoostClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">AdaBoostClassifier</span>
<span class="n">model_ab</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;SAMME.R&quot;</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">global_seed</span> <span class="p">)</span>
<span class="n">model_ab</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">x_train_sm</span><span class="p">,</span> <span class="n">y_train_sm</span> <span class="p">)</span>
<span class="n">y_pred_ab</span> <span class="o">=</span> <span class="n">model_ab</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span> <span class="n">x_test</span> <span class="p">)</span>

<span class="n">EvaluateModel</span><span class="p">(</span> <span class="n">model_ab</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_ab</span> <span class="p">)</span>

<span class="c1">#/-</span>

<span class="c1">#/*</span>

<span class="c1">#/#</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Model Score :  0.9392523364485982 

[[754  47]
 [ 44 653]] 

              precision    recall  f1-score   support

           1       0.94      0.94      0.94       801
           2       0.93      0.94      0.93       697

   micro avg       0.94      0.94      0.94      1498
   macro avg       0.94      0.94      0.94      1498
weighted avg       0.94      0.94      0.94      1498

Model Score :  0.9779706275033377 

[[779  22]
 [ 11 686]] 

              precision    recall  f1-score   support

           1       0.99      0.97      0.98       801
           2       0.97      0.98      0.98       697

   micro avg       0.98      0.98      0.98      1498
   macro avg       0.98      0.98      0.98      1498
weighted avg       0.98      0.98      0.98      1498

Model Score :  0.9125500667556742 

[[726  75]
 [ 56 641]] 

              precision    recall  f1-score   support

           1       0.93      0.91      0.92       801
           2       0.90      0.92      0.91       697

   micro avg       0.91      0.91      0.91      1498
   macro avg       0.91      0.91      0.91      1498
weighted avg       0.91      0.91      0.91      1498

Model Score :  0.7790387182910548 

[[603 198]
 [133 564]] 

              precision    recall  f1-score   support

           1       0.82      0.75      0.78       801
           2       0.74      0.81      0.77       697

   micro avg       0.78      0.78      0.78      1498
   macro avg       0.78      0.78      0.78      1498
weighted avg       0.78      0.78      0.78      1498

</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>


 



<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.20.3.20823-65 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130'); });</script></body></html>